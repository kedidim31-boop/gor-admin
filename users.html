<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Benutzerverwaltung ‚Äì Gaming of Republic</title>
  <link rel="stylesheet" href="assets/css/layout.css">
  <style>
    body {
      background-color: #191833;
      color: #fff;
      font-family: sans-serif;
    }
    h1 {
      color: #ffd700;
      margin-bottom: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #444;
      padding: 0.5rem;
      text-align: center;
    }
    th {
      background-color: #111827;
      color: #ffd700;
    }
    .btn {
      background-color: #ffd700;
      color: #000;
      padding: 0.5rem 1rem;
      border: none;
      font-weight: bold;
      cursor: pointer;
      border-radius: 4px;
      margin-right: 0.5rem;
    }
    .btn.delete {
      background-color: #e63946;
      color: #fff;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="logo">üïπÔ∏è Gaming of Republic</div>
    <ul>
      <li><a href="index.html">Dashboard</a></li>
      <li><a href="products.html">Produkte</a></li>
      <li><a href="users.html" class="active">Benutzerverwaltung</a></li>
      <li><button id="logoutBtn" class="btn delete">üö™ Abmelden</button></li>
    </ul>
  </nav>

  <main class="content">
    <h1>Benutzerverwaltung</h1>

    <table id="userTable">
      <thead>
        <tr>
          <th>Benutzername</th>
          <th>Rolle</th>
          <th>Aktionen</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h2>‚ûï Neuen Benutzer hinzuf√ºgen</h2>
    <form id="userForm">
      <label>Benutzername</label>
      <input type="text" id="username" required>

      <label>Rolle</label>
      <select id="role">
        <option value="viewer">Viewer</option>
        <option value="editor">Editor</option>
        <option value="admin">Admin</option>
      </select>

      <button type="submit" class="btn">‚úÖ Benutzer speichern</button>
    </form>
  </main>

<script>
  // Zugriffsschutz
  const user = localStorage.getItem("loggedInUser");
  const role = localStorage.getItem("userRole");

  if (!user) window.location.href = "login.html";

  if (role !== "admin") {
    alert("Zugriff verweigert ‚Äì Nur Admins d√ºrfen Benutzer verwalten.");
    window.location.href = "index.html";
  }

  // Benutzerliste laden
  const tbody = document.querySelector("#userTable tbody");
  let userList = JSON.parse(localStorage.getItem("userList")) || [];

  function renderUsers() {
    tbody.innerHTML = "";
    userList.forEach((u, i) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${u.username}</td>
        <td>${u.role}</td>
        <td>
          <button class="btn delete" data-index="${i}">üóëÔ∏è L√∂schen</button>
        </td>
      `;
      tbody.appendChild(tr);
    });

    document.querySelectorAll(".delete").forEach(btn => {
      btn.addEventListener("click", () => {
        const index = btn.getAttribute("data-index");
        if(confirm("Willst du diesen Benutzer wirklich l√∂schen?")) {
          userList.splice(index, 1);
          localStorage.setItem("userList", JSON.stringify(userList));
          renderUsers();
        }
      });
    });
  }
  renderUsers();

  // Neuen Benutzer speichern
  document.getElementById("userForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const newUser = {
      username: document.getElementById("username").value,
      role: document.getElementById("role").value
    };
    userList.push(newUser);
    localStorage.setItem("userList", JSON.stringify(userList));
    alert("‚úÖ Benutzer gespeichert!");
    renderUsers();
    document.getElementById("userForm").reset();
  });

  // Logout
  document.getElementById("logoutBtn").addEventListener("click", () => {
    localStorage.removeItem("loggedInUser");
    localStorage.removeItem("userRole");
    alert("Du wurdest abgemeldet.");
    window.location.href = "login.html";
  });
</script>
</body>
</html>
