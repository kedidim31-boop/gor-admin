<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gaming of Republic â€“ Login</title>
  <link rel="stylesheet" href="assets/css/layout.css">
</head>
<body>
  <main class="content login-container">
    <div class="login-card">
      <h1 class="logo">ğŸ•¹ï¸ Gaming of Republic</h1>
      <h2>Login</h2>

      <!-- Login Formular -->
      <form id="loginForm">
        <label>Benutzername</label>
        <input type="text" name="username" placeholder="Dein Benutzername" required>

        <label>Passwort</label>
        <input type="password" name="password" placeholder="********" required>

        <button type="submit" class="btn">ğŸ”‘ Anmelden</button>
      </form>

      <!-- Abmelden Button (wird nur angezeigt, wenn eingeloggt) -->
      <button id="logoutBtn" class="btn delete" style="display:none;">ğŸšª Abmelden</button>

      <p class="register-link">Noch kein Konto? <a href="register.html">Registrieren</a></p>
    </div>
  </main>

  <script>
    const loginForm = document.getElementById('loginForm');
    const logoutBtn = document.getElementById('logoutBtn');

    // PrÃ¼fen ob bereits eingeloggt
    if(localStorage.getItem("loggedInUser")) {
      loginForm.style.display = "none"; // Login-Formular ausblenden
      logoutBtn.style.display = "inline-block"; // Logout anzeigen
    }

    // Login Logik mit userList aus localStorage
    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const username = this.username.value.trim();
      const password = this.password.value.trim();

      // Benutzerliste laden (von users.html gespeichert)
      let users = JSON.parse(localStorage.getItem("userList")) || [];

      // Falls Liste leer ist, Standard-Admin setzen
      if(users.length === 0) {
        users.push({
          username: "admin",
          email: "admin@gor.com",
          password: "1234",
          role: "admin",
          status: "Aktiv"
        });
        localStorage.setItem("userList", JSON.stringify(users));
      }

      // Benutzer suchen (nur aktive Accounts)
      const foundUser = users.find(u =>
        u.username === username &&
        u.password === password &&
        u.status === "Aktiv"
      );

      if(foundUser) {
        localStorage.setItem("loggedInUser", foundUser.username);
        localStorage.setItem("userRole", foundUser.role);
        alert("Login erfolgreich als " + foundUser.role + "!");
        window.location.href = "index.html"; // Weiterleitung zum Dashboard
      } else {
        alert("UngÃ¼ltige Zugangsdaten oder Benutzer nicht aktiv!");
      }
    });

    // Logout Logik
    logoutBtn.addEventListener('click', () => {
      localStorage.removeItem("loggedInUser");
      localStorage.removeItem("userRole");
      alert("Du wurdest abgemeldet.");
      window.location.href = "login.html"; // zurÃ¼ck zur Login-Seite
    });
  </script>
</body>
</html>
